commonConfig:
  databaseUrl: "postgresql://$(DATABASE_ENDPOINT)/kmsconnector"
  # Cannot be used for tx-sender until full node supports eth_sendRawTransactionSync
  # gatewayUrl: "http://gateway-node:8547"
  gatewayUrl: "$(CONDUIT_RPC_HTTP_URL)"
  chainId: "261131"
  gatewayContractAddresses:
    decryption: "0x0f6024a97684f7d90ddb0fAAD79cB15F2C888D24"
    gatewayConfig: "0xDE537Be194777A56f8B19d14079E6a78249390ab"
    kmsGeneration: "0x290947F9fed2d91fdB22f35E162aDfA744b7aEe3"
  env:
    - name: DATABASE_ENDPOINT
      valueFrom:
        secretKeyRef:
          name: connector-database
          key: endpoint
    - name: PGUSER
      valueFrom:
        secretKeyRef:
          name: connector-database
          key: username
    - name: PGPASSWORD
      valueFrom:
        secretKeyRef:
          name: connector-database
          key: password
    - name: CONDUIT_RPC_HTTP_URL
      valueFrom:
        secretKeyRef:
          name: conduit
          key: conduit-rpc-http-url

kmsConnectorDbMigration:
  enabled: true
  image:
    name: hub.zama.org/zama-protocol/zama-ai/fhevm/kms-connector/db-migration
    tag: v0.10.7
  env: []
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: "node.kubernetes.io/enclave-enabled"
                operator: In
                values:
                  - "true"
  tolerations:
    - key: "node.kubernetes.io/enclave-enabled"
      effect: NoSchedule
      operator: Equal
      value: "true"

kmsConnectorGwListener:
  enabled: true
  nameOverride: kms-connector-gw-listener
  image:
    name: hub.zama.org/zama-protocol/zama-ai/fhevm/kms-connector/gw-listener
    tag: v0.10.7
  replicas: 1
  config:
    # Use full node
    gatewayUrl: "http://gateway-node:8547"
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: "node.kubernetes.io/enclave-enabled"
                operator: In
                values:
                  - "true"
  tolerations:
    - key: "node.kubernetes.io/enclave-enabled"
      effect: NoSchedule
      operator: Equal
      value: "true"

kmsConnectorKmsWorker:
  enabled: true
  nameOverride: kms-connector-kms-worker
  image:
    name: hub.zama.org/zama-protocol/zama-ai/fhevm/kms-connector/kms-worker
    tag: v0.10.7
  replicas: 1
  config:
    kmsCoreEndpoints: "http://kms-core:50100"
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: "node.kubernetes.io/enclave-enabled"
                operator: In
                values:
                  - "true"
  tolerations:
    - key: "node.kubernetes.io/enclave-enabled"
      effect: NoSchedule
      operator: Equal
      value: "true"

kmsConnectorTxSender:
  enabled: true
  nameOverride: kms-connector-tx-sender
  image:
    name: hub.zama.org/zama-protocol/zama-ai/fhevm/kms-connector/tx-sender
    tag: v0.10.7
  replicas: 1
  serviceAccountName: mpc-party-connector
  wallet:
    # Use the kms-connector tx-sender KMS key as ethereum wallet
    awsKms:
      enabled: true
      configmap:
        name: mpc-party
        key: KMS_CONNECTOR__TX_SENDER_AWS_KMS_KEY_ID
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
              - key: "node.kubernetes.io/enclave-enabled"
                operator: In
                values:
                  - "true"
  tolerations:
    - key: "node.kubernetes.io/enclave-enabled"
      effect: NoSchedule
      operator: Equal
      value: "true"
